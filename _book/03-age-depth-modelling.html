<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Palaeoecological data-science: a data driven curriculum - 4&nbsp; Age-depth modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-neotoma2.html" rel="next">
<link href="./02-intro-to-R.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Age-depth modelling</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Palaeoecological data-science: a data driven curriculum</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Neotoma Explorer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-intro-to-R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Intro to R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-age-depth-modelling.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Age-depth modelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-neotoma2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The <code>neotoma2</code> package</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-wrangling-visualisation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data wrangling and visualisations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-exploratory-analyses.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploratory analyses</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-dissimilarity-roc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dissimilarity and Rates of Change</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-no-analogue.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Novelty and No Analogue Futures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-ordination-pca.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Ordination: Principal Component Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-ordination-nmds.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Ordination: Non-metric Dimension Scaling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-gams.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Generalised Additive Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-tapas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Charcoal Analysis using TAPAS</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-psm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Proxy System Modelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-test-chapter.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Test pad to delete</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#part-1-background" id="toc-part-1-background" class="nav-link active" data-scroll-target="#part-1-background"><span class="toc-section-number">4.1</span>  Part 1: Background</a></li>
  <li><a href="#part-2-code" id="toc-part-2-code" class="nav-link" data-scroll-target="#part-2-code"><span class="toc-section-number">4.2</span>  Part 2: Code</a>
  <ul class="collapse">
  <li><a href="#calibration-of-radiocarbon-dates" id="toc-calibration-of-radiocarbon-dates" class="nav-link" data-scroll-target="#calibration-of-radiocarbon-dates"><span class="toc-section-number">4.2.1</span>  Calibration of Radiocarbon Dates</a></li>
  <li><a href="#types-of-age-depth-models" id="toc-types-of-age-depth-models" class="nav-link" data-scroll-target="#types-of-age-depth-models"><span class="toc-section-number">4.2.2</span>  Types of Age-Depth Models</a></li>
  </ul></li>
  <li><a href="#part-3-exercises" id="toc-part-3-exercises" class="nav-link" data-scroll-target="#part-3-exercises"><span class="toc-section-number">4.3</span>  Part 3: Exercises</a>
  <ul class="collapse">
  <li><a href="#calibration" id="toc-calibration" class="nav-link" data-scroll-target="#calibration"><span class="toc-section-number">4.3.1</span>  Calibration</a></li>
  <li><a href="#classical-age-depth-modelling" id="toc-classical-age-depth-modelling" class="nav-link" data-scroll-target="#classical-age-depth-modelling"><span class="toc-section-number">4.3.2</span>  Classical age-depth modelling:</a></li>
  <li><a href="#bayesian-age-depth-modelling" id="toc-bayesian-age-depth-modelling" class="nav-link" data-scroll-target="#bayesian-age-depth-modelling"><span class="toc-section-number">4.3.3</span>  Bayesian age-depth modelling</a></li>
  </ul></li>
  <li><a href="#learning-outcomes-rephraseexclude" id="toc-learning-outcomes-rephraseexclude" class="nav-link" data-scroll-target="#learning-outcomes-rephraseexclude"><span class="toc-section-number">4.4</span>  Learning outcomes (Rephrase/exclude)</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-age-depth" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Age-depth modelling</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="part-1-background" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="part-1-background"><span class="header-section-number">4.1</span> Part 1: Background</h2>
<p>A foundational difference between geology and ecology is that, for geologists, time is an unknown variable that must be estimated with uncertainty. In contrast, most ecologists can assume that the temporal coordinates of their observations are known precisely, with zero uncertainty. Fortunately, geochronologists have a wide variety of natural clocks, thanks to the constant decay rates of radioactive isotopes. Each isotope has a unique decay rate, and so each is appropriate for particular timescales.</p>
<p>For the last 50,000 years, radiocarbon (<sup>14</sup>C), with its half-life of 5,730 years, is by far the most common form of radiometric dating. (Beyond 10 half-lives, so much of a radioactive substance has decayed away that it becomes immeasurable.) Radiocarbon is the mainstay of Quaternary dating and archaeology.</p>
<p>In Quaternary paleoecology, radiocarbon dating is expensive – a single sample typically costs $300 to $500 – so usually a given lake-sediment record will have only a scattering (ca. 5 to 30) of radiocarbon dates and other age controls. Other kinds of age controls include volcanic ash layers (tephras), <sup>210</sup>Pb (half-life: 22.6 yrs), optically stimulated luminescence (OSL) dates, historic events such as the rise in <em>Ambrosia</em> pollen abundances associated with EuroAmerican land clearance, etc. An age-depth model must be constructed to estimate the age of sediments not directly associated with an age control. In multi-site data syntheses, the number of age controls, their precision, and their likely accuracy are all fundamental indicators of data quality <span class="citation" data-cites="blois2011 mottl2021">(e.g. <a href="references.html#ref-blois2011" role="doc-biblioref">Blois et al. 2011</a>; <a href="references.html#ref-mottl2021" role="doc-biblioref">Mottl et al. 2021</a>)</span>.</p>
<p>To estimate ages for depths lacking radiocarbon date, an age-depth model is required. Age-depth models are fitted to the available age controls (age estimates with uncertainty for individual depths) and provide estimates of age as a function of depth, for all depths and ages within the temporal bounds of the model.</p>
</section>
<section id="part-2-code" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="part-2-code"><span class="header-section-number">4.2</span> Part 2: Code</h2>
<p>Here we will gain practice in working with age-depth models of various kind, and assessing their age estimates and uncertainty. We’ll begin with a bit of practice in calibrating radiocarbon years to calendar years and comparing the resulting age estimates from different calibration curves.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Packages required for this section
</div>
</div>
<div class="callout-body-container callout-body">
<p>We will be using <code>Bchron</code> for calibration and Bayesian age-depth modelling. Notably <code>rbacon</code> is another commonly used package, see <span class="citation" data-cites="trachsel2017">Trachsel and Telford (<a href="references.html#ref-trachsel2017" role="doc-biblioref">2017</a>)</span> for a discussion on age-depth models. We will also be fitting some interpolation and linear models using BASE-R. Remember you must have packages both installed <em>and</em> loaded, often loading a package is done via the <code>library(packagename)</code> function. The following code using the <code>pacman</code> package takes care of installation and loading in one go.</p>
<div class="cell" data-hash="03-age-depth-modelling_cache/html/packages_fdccbbee35431c797533bb2c728c91c8">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load up the package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>, <span class="at">repos=</span><span class="st">"http://cran.r-project.org"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(Bchron, splines) <span class="co"># splines comes with BASE-R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="calibration-of-radiocarbon-dates" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="calibration-of-radiocarbon-dates"><span class="header-section-number">4.2.1</span> Calibration of Radiocarbon Dates</h3>
<p>A complication in radiocarbon dating is that the initial calculation of a radiocarbon age assumes, by convention, that the amount of radiocarbon in the atmosphere is constant over time. See Bronk Ramsey (2008) for a good overview of <sup>14</sup>C dating. This assumption is untrue, so all radiocarbon age estimates must be post-hoc calibrated using a calibration curve that is based on compiling radiocarbon dates of materials that have precise independent age estimates (e.g.&nbsp;tree rings, corals). The IntCal series (IntCal04, IntCal09, IntCal13, IntCal20) is the community standard for calibrating radiocarbon dates to age estimates in calendar years <span class="citation" data-cites="reimer2020">(e.g., <a href="references.html#ref-reimer2020" role="doc-biblioref">Reimer et al. 2020</a>)</span>. The conversion from radiocarbon to calendar years usually further increases the uncertainty of age estimates.</p>
<p>Yet another complication in radiocarbon dating is that different calibration curves need to be used for the Northern vs.&nbsp;Southern Hemisphere and for the atmosphere vs.&nbsp;oceans, due to different residence times of <sup>14</sup>C in these different reservoirs. For example, atmospheric radiocarbon that diffuses into the surface oceans usually will reside for centuries before phytoplankton biologically fix it through photosynthesis, which will lead marine <sup>14</sup>C to be depleted (and ‘too old’) relative to atmospheric <sup>14</sup>C. Use the wrong calibration curve and your age estimate will be inaccurate!</p>
<section id="calibrating-radiocarbon-dates-in-r" class="level4" data-number="4.2.1.1">
<h4 data-number="4.2.1.1" class="anchored" data-anchor-id="calibrating-radiocarbon-dates-in-r"><span class="header-section-number">4.2.1.1</span> Calibrating radiocarbon dates in R</h4>
<p>Here we’ll experiment with calibrating radiocarbon dates, using various calibration curves. Radiocarbon dated samples come back from the lab with a radiocarbon age and standard deviation, among other information. These two bits of information are used to calibrate the radiocarbon dates to estimated ages. R packages may have useful vignettes (package tutorials) and built-in datasets that provide handy test templates. The following code is modified from the <code>Bchron</code> <a href="https://cran.r-project.org/web/packages/Bchron/vignettes/Bchron.html">vignette</a>.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Plots</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Calibration curve plots</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-hash="03-age-depth-modelling_cache/html/BchronCalibrate_a21a845fb608127cab03df28a1670974">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">=</span> <span class="fu">BchronCalibrate</span>(<span class="at">ages=</span><span class="fu">c</span>(<span class="dv">3445</span>,<span class="dv">11553</span>,<span class="dv">7456</span>), </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ageSds=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">230</span>,<span class="dv">110</span>), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">calCurves=</span><span class="fu">c</span>(<span class="st">'intcal20'</span>,<span class="st">'intcal20'</span>,<span class="st">'intcal20'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-hash="03-age-depth-modelling_cache/html/BchronCalibrateSummary_fd345464d605ee5366160c1f57d54b90">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Highest density regions for Date1
$`94.4%`
[1] 3572 3834


95% Highest density regions for Date2
$`0.4%`
[1] 13004 13025

$`77.9%`
[1] 13059 13874

$`16.4%`
[1] 13923 14012


95% Highest density regions for Date3
$`94.6%`
[1] 8022 8423</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-hash="03-age-depth-modelling_cache/html/BchronCalibratePlot_4f4e7516824cca68ff4f25f622646ab5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03-age-depth-modelling_files/figure-html/BchronCalibratePlot-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03-age-depth-modelling_files/figure-html/BchronCalibratePlot-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03-age-depth-modelling_files/figure-html/BchronCalibratePlot-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell" data-hash="03-age-depth-modelling_cache/html/BchronCalibrateCalPlot_1be9b4aefead343c4175d77072d22f9e">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ages, <span class="at">includeCal =</span> <span class="cn">TRUE</span>, <span class="at">fillCol =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-age-depth-modelling_files/figure-html/BchronCalibrateCalPlot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>The output summary indicates the range of the highest density regions (i.e., the most likely ‘real’ age range of the sample). The <code>plot</code> function in <code>Bchron</code> outputs a <code>ggplot</code> object of the high density regions of the most likely ages.</p>
</section>
</section>
<section id="types-of-age-depth-models" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="types-of-age-depth-models"><span class="header-section-number">4.2.2</span> Types of Age-Depth Models</h3>
<p>Different kinds of age-depth models exist, each with their own underlying assumptions and behavior. In the list below, #1-4 are classical or traditional forms of age-depth models, but Bayesian models are now the norm. The packages <code>rbacon</code> (usually referred to as ‘bacon’) and <code>Bchron</code> are the current standards for Bayesian age-depth modelling. Before going to bayesian models, we’ll begin with the classics.</p>
<ol type="1">
<li><p><strong>Linear interpolation</strong>, a.k.a. ‘connect the dots,’ in which straight lines are drawn between each depth-adjacent pair of age controls.</p></li>
<li><p><strong>Linear regression</strong> (<span class="math inline">\(y=b0~ + b1x\)</span>; <span class="math inline">\(y=\)</span>time and <span class="math inline">\(x=\)</span>depth; <span class="math inline">\(b0\)</span> and <span class="math inline">\(b1\)</span> are constants), in which a single straight line is fitted through the entire set of age controls. In ordinary linear regression (OLS), the chosen line will minimize the y-dimension distances of individual points to the line. Standard OLS assumes that all observations are normally distributed, which is a poor assumption for calibrated radiocarbon dates.</p></li>
<li><p><strong>Polynomials</strong>, also fitted to the entire set of age controls (<span class="math inline">\(y= b0 + b1x + b2x^2 + b3x^3 + …bnx^n\)</span>), are an extension of linear regression, with additional terms for <span class="math inline">\(x^2\)</span>, <span class="math inline">\(x^3\)</span>, etc. Some arbitrary maximum n is chosen, usually in the range of 3 to 5. These are called ‘third-order polynomials,’ ‘fifth-order polynomials,’ etc.</p></li>
<li><p><strong>Splines</strong>, which are a special kind of polynomial function that are locally fitted to subsets of the age controls, and then smoothly interpolated between points. (Several different formulas can be used to generate splines; common forms include cubic, smooth, monotonic, and LOWESS).</p></li>
<li><p><strong>Bayesian age models</strong> (e.g.&nbsp;<code>bacon</code>, <code>bchron</code>, <code>oxcal</code>, etc.). Bayesian models differ in detail, but all combine a statistical representation of prior knowledge with the new data (i.e.&nbsp;the age controls at a site) to build an age-depth model with posterior estimates of age for any given depth. Bayesian models are now widely used because</p>
<ol type="i">
<li>they allow the incorporation of prior knowledge (e.g., from coring many lakes, we now have decent estimates of typical sediment accumulation rates, <span class="citation" data-cites="goring2012">Goring et al. (<a href="references.html#ref-goring2012" role="doc-biblioref">2012</a>)</span>);</li>
<li>they can handle highly irregular probability distribution functions such as those for radiocarbon dates after calibration; and as a result</li>
<li>they generally do a better job of describing uncertainty than traditional age-depth models.</li>
</ol></li>
</ol>
<section id="classical-age-depth-models" class="level4" data-number="4.2.2.1">
<h4 data-number="4.2.2.1" class="anchored" data-anchor-id="classical-age-depth-models"><span class="header-section-number">4.2.2.1</span> Classical age-depth models</h4>
<p>Classical models are now out-dated methods <span class="citation" data-cites="blaauw2018">(<a href="references.html#ref-blaauw2018" role="doc-biblioref">Blaauw et al. 2018</a>)</span>, but it is useful to understand how they work as literature before the relatively recent development of Bayesian methods has relied on them. Let’s explore some classical methods of age-depth modelling using one of the datasets included with the <code>Bchron</code> package. The data are from a core in Northern Ireland; Sluggan Bog <span class="citation" data-cites="smith1991">Smith and Goddard (<a href="references.html#ref-smith1991" role="doc-biblioref">1991</a>)</span>, and can be called via:</p>
<div class="cell" data-hash="03-age-depth-modelling_cache/html/Classical_a1792ae713f6ec7d77d18cf13128e133">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Sluggan) <span class="co"># Call the data from Bchron</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Sluggan) <span class="co"># Check out the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Linear interpolation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Linear regression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Polynomial regression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Cubic splines</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Linear interpolation predicts ages by simply, drawing a line between successive dated samples. This method assumes that there is a constant age-depth relationship between samples. An assumption that is unlikely to be true, especially of cores with fewer dated samples than Sluggan Moss.</p>
<div class="cell" data-hash="03-age-depth-modelling_cache/html/LinearInterp_31a30a9b3a6326a931ced14f1efdc65d">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>interp_ages <span class="ot">&lt;-</span> <span class="fu">approx</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position) <span class="co"># use the function approx() to interpolate between ages</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> interp_ages<span class="sc">$</span>x, <span class="at">y =</span> interp_ages<span class="sc">$</span>y, <span class="at">type =</span> <span class="st">'l'</span>) <span class="co"># Plot the interpolated data</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">'red'</span>) <span class="co"># overlay the original age points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-age-depth-modelling_files/figure-html/LinearInterp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Linear regression provides a line of best fit through the dated samples. This method assumes a constant age-depth relationship across all samples, also unlikely to be true depending on processes affecting the core during its formation.</p>
<div class="cell" data-hash="03-age-depth-modelling_cache/html/LinearReg_eca9c62b0657bfc8d610c896fe7de67a">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mod_ages <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sluggan<span class="sc">$</span>position <span class="sc">~</span> Sluggan<span class="sc">$</span>ages) <span class="co"># Create a linear regression model</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">'red'</span>) <span class="co"># Plot the original ages</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mod_ages) <span class="co"># add the regression line from the regression model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-age-depth-modelling_files/figure-html/LinearReg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Polynomial regression allows a curve to be fit through the data. The amount the curve ‘wiggles’ depends on the order of the polynomial fit to the data. Polynomial regression has the risk of being over-fit.</p>
<div class="cell" data-hash="03-age-depth-modelling_cache/html/PolyReg_be4fdab94892fb47a3a3cdafc9aefa48">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> Sluggan<span class="sc">$</span>ages <span class="co"># Renaming the variables because the predict function below is fussy about the input name</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Sluggan<span class="sc">$</span>position</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>poly_ages <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>age_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">range</span>(Sluggan<span class="sc">$</span>ages)[<span class="dv">1</span>], <span class="at">to =</span> <span class="fu">range</span>(Sluggan<span class="sc">$</span>ages)[<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">250</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(age_range, <span class="fu">predict</span>(poly_ages, <span class="fu">data.frame</span>(<span class="at">x =</span> age_range)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-age-depth-modelling_files/figure-html/PolyReg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Splines are a class of functions including, for example, smoothing splines or cubic splines. Cubic splines are pieve-wise polynomials locally between ‘knots’. That is the data are split into bins that are fit independently using. By default, the <code>bs()</code> function uses a third degree polynomial. Without providing knots the fit will look the same as a third degree polynomial regression.</p>
<div class="cell" data-hash="03-age-depth-modelling_cache/html/CubicSpline_d5495c5a5dfd61791850d754c2e56183">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>cubic_ages <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">bs</span>(x, <span class="at">knots =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">6000</span>, <span class="dv">12000</span>)))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Sluggan<span class="sc">$</span>ages, <span class="at">y =</span> Sluggan<span class="sc">$</span>position, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(age_range, <span class="fu">predict</span>(cubic_ages, <span class="fu">data.frame</span>(<span class="at">x =</span> age_range)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-age-depth-modelling_files/figure-html/CubicSpline-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Because classical age-depth modelling is rarely used now we are not going to delve further into the statistical details of the best way of fitting each model (e.g., the number of knots to use for fitting a cubic spline).</p>
<p>One of the issues with classical age-depth modelling is that uncertainty <em>decreases</em> with fewer datapoints.</p>
</section>
<section id="bayesian-age-depth-models" class="level4" data-number="4.2.2.2">
<h4 data-number="4.2.2.2" class="anchored" data-anchor-id="bayesian-age-depth-models"><span class="header-section-number">4.2.2.2</span> Bayesian age-depth models</h4>
<p>Now let’s see what the latest methods show for the same dataset.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Note that all the values provided to the arguments are contained in the Sluggan dataframe. When creating chronologies from your own (or accessed data), you may need to rename them to match your data.</p>
<div class="cell" data-hash="03-age-depth-modelling_cache/html/Bayesian_d089ac12966b77e57fed5212fa0665a8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>SlugganOut <span class="ot">=</span> <span class="fu">with</span>(Sluggan, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">Bchronology</span>(<span class="at">ages=</span>ages,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ageSds=</span>ageSds, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">calCurves=</span>calCurves,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">positions=</span>position, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">positionThicknesses=</span>thickness,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ids=</span>id, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">predictPositions=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">518</span>, <span class="at">by=</span><span class="dv">10</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>The summary shows for each position (depth) the median and quartiles of the predicted ages for that position.</p>
<div class="cell" data-hash="03-age-depth-modelling_cache/html/BayesianSummary_ad8bc5e0dfb560b6a0bef365314a681e">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SlugganOut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Quantiles of predicted ages by depth: 
 Depth      2.5%      25%     50%      75%     97.5%
     0   -56.050    75.00   232.5   410.25   697.075
    10    28.000   234.75   389.5   540.50   786.075
    20   133.000   378.50   523.0   653.00   830.050
    30   268.925   540.75   654.0   755.00   881.025
    40   513.950   718.00   794.0   852.00   927.050
    50   959.975  1067.75  1130.0  1198.00  1328.000
    60  1140.925  1268.75  1332.0  1397.25  1535.000
    70  1388.975  1494.00  1552.5  1613.00  1753.075
    80  1500.950  1650.75  1740.0  1839.25  2024.100
    90  1622.975  1809.75  1909.5  1999.25  2165.050
   100  1846.000  2017.75  2077.0  2162.25  2275.000
   110  2167.975  2353.75  2477.0  2622.75  2903.025
   120  2407.000  2712.75  2841.0  2946.00  3115.100
   130  2977.825  3150.75  3252.0  3390.00  3770.100
   140  3118.000  3371.75  3531.0  3721.25  4074.075
   150  3310.950  3664.00  3830.0  3996.00  4250.025
   160  3637.875  3990.00  4127.5  4222.00  4408.075
   170  4207.975  4342.75  4420.0  4494.25  4632.325
   180  4343.950  4494.00  4565.0  4639.00  4753.050
   190  4539.000  4663.00  4736.0  4809.25  4935.050
   200  4611.850  4756.00  4830.0  4900.00  5052.075
   210  4697.950  4843.75  4914.0  4987.00  5120.025
   220  4788.850  4926.00  4997.5  5060.00  5194.000
   230  4917.000  5040.75  5095.0  5156.00  5278.000
   240  5518.975  5637.00  5678.5  5722.00  5849.000
   250  5635.950  5737.75  5790.5  5848.25  5961.025
   260  5712.975  5829.00  5888.5  5940.00  6054.000
   270  5841.925  5949.00  5994.0  6041.25  6127.000
   280  6292.950  6481.75  6628.0  6813.50  7237.025
   290  6568.625  6972.00  7147.0  7302.50  7523.125
   300  7500.875  7616.75  7686.0  7780.25  8061.075
   310  7635.900  7809.75  7945.0  8107.00  8427.175
   320  7795.950  8070.00  8215.0  8348.25  8611.025
   330  8106.925  8390.00  8473.0  8572.00  8785.000
   340  8485.950  8597.00  8677.0  8768.25  8960.150
   350  8558.975  8694.00  8792.0  8872.00  9047.225
   360  8623.950  8794.00  8899.0  8985.00  9130.000
   370  9053.000  9214.00  9284.0  9360.25  9487.025
   380  9149.000  9312.00  9386.5  9470.00  9637.050
   390  9226.975  9389.75  9470.5  9556.25  9778.075
   400  9324.975  9471.00  9552.0  9651.00  9882.250
   410  9495.975  9650.75  9748.0  9872.00 10131.025
   420  9639.950  9844.00  9984.0 10115.25 10287.025
   430  9834.925 10081.75 10262.5 10323.00 10464.050
   440  9959.725 10198.00 10315.0 10387.00 10546.275
   450 10438.000 10580.00 10675.0 10777.25 11049.050
   460 10690.975 10896.00 11021.0 11112.50 11267.050
   470 11150.950 11520.00 11722.0 11964.25 12408.075
   480 11636.925 12178.75 12391.5 12541.25 12702.050
   490 12753.925 12864.00 12921.5 12978.00 13101.025
   500 12912.000 13052.00 13112.0 13183.00 13380.025
   510 13340.975 13500.75 13598.5 13703.25 13892.000</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell" data-hash="03-age-depth-modelling_cache/html/BayesianPlots_0066df0e586e5a8197eabaac02969daf">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SlugganOut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-age-depth-modelling_files/figure-html/BayesianPlots-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>A more complete version of the modelling process using Bchron can be found in the <a href="https://cran.r-project.org/web/packages/Bchron/vignettes/Bchron.html">vignette</a>.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Resources
</div>
</div>
<div class="callout-body-container callout-body">
<p>Age-depth modelling is complicated, there are many pitfalls, assumptions, and uncertainties that are often ignored. Recent developments have begun to focus on quantifying uncertainties to understand the reliability of inferences made from the data. Ket papers for understanding age depth modelling include:</p>
<ul>
<li><p><span class="citation" data-cites="blaauw2018">Blaauw et al. (<a href="references.html#ref-blaauw2018" role="doc-biblioref">2018</a>)</span></p></li>
<li><p><span class="citation" data-cites="parnell2008">Parnell et al. (<a href="references.html#ref-parnell2008" role="doc-biblioref">2008</a>)</span></p></li>
<li><p><span class="citation" data-cites="trachsel2017">Trachsel and Telford (<a href="references.html#ref-trachsel2017" role="doc-biblioref">2017</a>)</span></p></li>
</ul>
</div>
</div>
</section>
</section>
</section>
<section id="part-3-exercises" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="part-3-exercises"><span class="header-section-number">4.3</span> Part 3: Exercises</h2>
<p>You may want to refer to the bchron vignette to find some helpful information for the exercises below.</p>
<section id="calibration" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="calibration"><span class="header-section-number">4.3.1</span> Calibration</h3>
<ol type="1">
<li>Using the existing example code, change the <code>calCurves</code> input to:
<ol type="i">
<li>the Southern Hemisphere calibration curve</li>
<li>the marine sediments curve.</li>
</ol></li>
<li>Calibrate a different set of three ages by modifying the inputs to <code>ages</code> and <code>ageSds</code>.</li>
</ol>
<p>The object you assigned the result of <code>BchronCalibrate</code> to contains all the calibration information and can be accessed with the <code>$</code> e.g., <code>ages$Date1$ageGrid</code></p>
<ol start="3" type="1">
<li>Using one of your calibrated sets of three dates, calculate the median age from the <code>ageGrid</code> and the difference of each calibrated age to the original uncalibrated age.</li>
</ol>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Median and mean ages
</div>
</div>
<div class="callout-body-container callout-body">
<p>Commonly, only the median age is reported; however, it is good practice to report and consider the range of possible ages, especially when exploring synchroneity of events across space. Notice how <code>Bchron</code> focuses on delivering ranges and densities.</p>
</div>
</div>
</section>
<section id="classical-age-depth-modelling" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="classical-age-depth-modelling"><span class="header-section-number">4.3.2</span> Classical age-depth modelling:</h3>
<ol type="1">
<li><code>Bchron</code> has a second built-in dataset named Glendalough. Using the Glendalough dataset:
<ol type="i">
<li>Fit a linear interpolation, linear regression, three different order polynomials and a cubic spline</li>
<li>Plot the results</li>
</ol></li>
<li>Did you run into any errors or warnings? If so, why?</li>
</ol>
</section>
<section id="bayesian-age-depth-modelling" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="bayesian-age-depth-modelling"><span class="header-section-number">4.3.3</span> Bayesian age-depth modelling</h3>
<ol type="1">
<li>Run the <code>Bchron</code> age-depth model on the Glendalough dataset and consider:
<ol type="i">
<li>How does uncertainty change between the plot outputs between the Glendalough (a dataset with fewer radiocarbon dates) and Sluggan Moss (a data-rich site)</li>
<li>Run the summary funcion on the Glendalough model, does the output reflect the plot? Is there smaller uncertainty around samples? Why is interpreting results in the context of the uncertainty important?</li>
</ol></li>
</ol>
</section>
</section>
<section id="learning-outcomes-rephraseexclude" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="learning-outcomes-rephraseexclude"><span class="header-section-number">4.4</span> Learning outcomes (Rephrase/exclude)</h2>
<ul class="task-list">
<li><p><input type="checkbox" disabled="">Learn how to access and use-built in datasets</p></li>
<li><p><input type="checkbox" disabled="">Learn how to find package vignettes</p></li>
</ul>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-blaauw2018" class="csl-entry" role="doc-biblioentry">
Blaauw, Maarten, J. Andrés Christen, K. D. Bennett, and Paula J. Reimer. 2018. <span>“Double the Dates and Go for <span>Bayes</span> <span>Impacts</span> of Model Choice, Dating Density and Quality on Chronologies.”</span> <em>Quaternary Science Reviews</em> 188 (May): 58–66. <a href="https://doi.org/10.1016/j.quascirev.2018.03.032">https://doi.org/10.1016/j.quascirev.2018.03.032</a>.
</div>
<div id="ref-blois2011" class="csl-entry" role="doc-biblioentry">
Blois, Jessica L., John W. (Jack) Williams, Eric C. Grimm, Stephen T. Jackson, and Russell W. Graham. 2011. <span>“A Methodological Framework for Assessing and Reducing Temporal Uncertainty in Paleovegetation Mapping from Late-<span>Quaternary</span> Pollen Records.”</span> <em>Quaternary Science Reviews</em> 30 (15-16): 1926–39. <a href="https://doi.org/10.1016/j.quascirev.2011.04.017">https://doi.org/10.1016/j.quascirev.2011.04.017</a>.
</div>
<div id="ref-goring2012" class="csl-entry" role="doc-biblioentry">
Goring, S., J. W. Williams, J. L. Blois, S. T. Jackson, C. J. Paciorek, R. K. Booth, J. R. Marlon, M. Blaauw, and J. A. Christen. 2012. <span>“Deposition Times in the Northeastern <span>United States</span> During the <span>Holocene</span>: Establishing Valid Priors for <span>Bayesian</span> Age Models.”</span> <em>Quaternary Science Reviews</em> 48 (August): 54–60. <a href="https://doi.org/10.1016/j.quascirev.2012.05.019">https://doi.org/10.1016/j.quascirev.2012.05.019</a>.
</div>
<div id="ref-mottl2021" class="csl-entry" role="doc-biblioentry">
Mottl, Ondřej, Suzette G. A. Flantua, Kuber P. Bhatta, Vivian A. Felde, Thomas Giesecke, Simon Goring, Eric C. Grimm, et al. 2021. <span>“Global Acceleration in Rates of Vegetation Change over the Past 18,000 Years.”</span> <em>Science</em> 372 (6544): 860–64. <a href="https://doi.org/10.1126/science.abg1685">https://doi.org/10.1126/science.abg1685</a>.
</div>
<div id="ref-parnell2008" class="csl-entry" role="doc-biblioentry">
Parnell, A. C., J. Haslett, J. R. M. Allen, C. E. Buck, and B. Huntley. 2008. <span>“A Flexible Approach to Assessing Synchroneity of Past Events Using <span>Bayesian</span> Reconstructions of Sedimentation History.”</span> <em>Quaternary Science Reviews</em> 27 (19-20): 1872–85. <a href="https://doi.org/10.1016/j.quascirev.2008.07.009">https://doi.org/10.1016/j.quascirev.2008.07.009</a>.
</div>
<div id="ref-reimer2020" class="csl-entry" role="doc-biblioentry">
Reimer, Paula J, William E N Austin, Edouard Bard, Alex Bayliss, Paul G Blackwell, Christopher Bronk Ramsey, Martin Butzin, et al. 2020. <span>“The <span>IntCal20 Northern Hemisphere Radiocarbon Age Calibration Curve</span> (0 Cal <span class="nocase">kBP</span>).”</span> <em>Radiocarbon</em> 62 (4): 725–57. <a href="https://doi.org/10.1017/RDC.2020.41">https://doi.org/10.1017/RDC.2020.41</a>.
</div>
<div id="ref-smith1991" class="csl-entry" role="doc-biblioentry">
Smith, A. G., and I. C. Goddard. 1991. <span>“A 12500 <span>Year Record</span> of <span>Vegetational History</span> at <span>Sluggan Bog</span>, <span>Co</span>. <span>Antrim</span>, <span>N</span>. <span>Ireland</span> (<span>Incorporating</span> a <span>Pollen Zone Scheme</span> for the <span>Non-Specialist</span>).”</span> <em>The New Phytologist</em> 118 (1): 167–87. <a href="https://www.jstor.org/stable/2557698">https://www.jstor.org/stable/2557698</a>.
</div>
<div id="ref-trachsel2017" class="csl-entry" role="doc-biblioentry">
Trachsel, Mathias, and Richard J Telford. 2017. <span>“All Agedepth Models Are Wrong, but Are Getting Better.”</span> <em>The Holocene</em> 27 (6): 860–69. <a href="https://doi.org/10.1177/0959683616675939">https://doi.org/10.1177/0959683616675939</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-intro-to-R.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Intro to R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-neotoma2.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The <code>neotoma2</code> package</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>